select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%bru%' 
and Provider in ('Digital','Btone OI','H2H')




select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%cornetto%' or lower(brand) like '%magnum%' 
and Provider in ('Digital','Btone OI','H2H')




select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%dove%' 
and Provider in ('Digital','Btone OI','H2H')



select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%taj%' 
and Provider in ('Digital','Btone OI','H2H')


select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%knorr%' 
and Provider in ('Digital','Btone OI','H2H')


select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%lipton%' 
and Provider in ('Digital','Btone OI','H2H')


select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%surf%' 
and Provider in ('Digital','Btone OI','H2H')



select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(brand) like '%comfort%' 
and Provider in ('Digital','Btone OI','H2H')



select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(provider) like '%bebe%' 


select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,mobileno,'1' Optin_Hierarchy_level
,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_mobile a
inner join prmprogrammepdwheudb.southasia.pdwh_ref_region b
on a.mobileprefix=b.mobileprefix
where  lower(provider) like '%lakm%' 



--email address

 create multiset table lakme_emailaddress(
 Market varchar(10), Provider varchar(10), emailaddress varchar(300),
 Optin_Hierarchy_level varchar(5),Optin_Hierarchy_value varchar(20) ) 
 

insert into "GAIN_THEORY".lakme_emailaddress 
select distinct 'IN' ,'LK' ,email_hash,'1','Unilever' 
from PRM.lk_customer
where length(email_hash)>0

union

select distinct 'IN' ,'LK' ,email_hash,'1','Unilever' 
from PRM.lk_customer_master
where length(email_hash)>0;

 


select distinct 'IN' Market
,case when lower(Provider) like '%btone%' then 'BT' when lower(Provider) like '%careline%' then 'CL' 
when lower(Provider) like '%pure%' then 'PI' when lower(Provider) like '%kkt%' then 'KKT'
when lower(Provider) like '%digi%' then 'DL' when lower(Provider) like '%lakm%' then 'LK'
when lower(Provider) like '%h2h%' then 'H2H' when lower(Provider) like '%bebe%' then 'BB'
end Provider ,emailaddress,'1' Optin_Hierarchy_level ,'Unilever' Optin_Hierarchy_value
FROM prmprogrammepdwheudb.southasia.pdwh_counting_email
where  lower(Provider) like '%be%';





