campaign_overview_total_campaigns = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster]";
	
campaign_overview_homecare = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster] where [Category] ='Home Care'";
	
campaign_overview_food_beverage = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster] where [Category] ='Food & Beverage'";
	
campaign_overview_personal_care = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster] where [Category] ='Personal Care'";
	
campaign_overview_trader_campaigns = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster] where [Target] ='Trader'";
	
campaign_overview_consumer_campaigns = "select count(distinct [CampaignName]) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_CampaignMaster] where [Target] ='Consumer'";
	
campaign_overview_reached = "select sum(counts) as numericValue from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Reached' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a";
	
campaign_overview_connected = "select sum(counts) as numericValue from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Connected' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a";
	
campaign_overview_interacted = "select sum(counts) as numericValue from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'interacted' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a";
	
campaign_overview_redeemed = "select sum(counts) as numericValue from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Redeemed' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a";
	
campaign_overview_campaign_at_a_glance = "select CampaignName as campaignName, target, channel, Connected as connectedTraders, Interacted as interactedTraders, Reached as tradersReached, Redeemed as successfulRedemptions, Region as region, Brand as brand, SKU as sku from (select KPI,[CampaignName],target,channel,counts,Region,Brand,SKU from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] )as a  pivot(sum(counts) for KPI in ([Connected],[Interacted],[Reached],[Redeemed])) as pvt";

=============================
	
kpi_sla_response_time_sla="select sum(counts) as y,[OBD Response Bracket] as name,date1 from (select [OBD Response Bracket], (count([Entry_ID])) as counts, cast([Campaign Entry create date] as date) as date1,[Provider],[Region] from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [OBD Response Bracket] is not null group by [OBD Response Bracket],[Campaign Entry create date],[Provider],[Region]) as a where [Provider] is null and [Region] is null and date1 between @Startdate and @Enddate group by [OBD Response Bracket],date1,[Provider],[Region] order by name asc";
	
kpi_sla_recharge_success_rate_over_time = "select sum(counts) as sumtotal,[Recharge Tme Bracket],[Reward Status_1],date1,[Provider],[Region] from ( select [Recharge Tme Bracket],(count([Entry_ID])) as counts,[Reward Status_1],cast([Campaign Entry create date] as date) as date1,[Provider],[Region] from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Recharge Tme Bracket] is not null group by [Recharge Tme Bracket],[Reward Status_1],[Provider],[Region],cast([Campaign Entry create date] as date) ) as a where [Provider] IS NULL and [Region] IS NULL and date1 between @Startdate and @Enddate group by [Recharge Tme Bracket],date1,[Reward Status_1],[Provider],[Region]";
	
kpi_sla_sms_delivery_sla = "select sum(counts) as y,[SMS SLA Bracket] as name ,date1,[Provider],[Region] from (select [SMS SLA Bracket],(count([Entry_ID])) as counts, cast([Campaign Entry create date] as date) as date1,[Provider],[Region] from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [SMS SLA Bracket] is not null group by [SMS SLA Bracket], cast([Campaign Entry create date] as date),[Provider],[Region]) as a where [Provider] IS NULL and [Region] IS NULL and date1 between @Startdate and @Enddate group by [SMS SLA Bracket],date1,[Provider],[Region]";
	
kpi_sla_cost_per_acquisition = "select distinct [Campaign Name],[Placeholder_2] as numericValue from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Campaign Name] is not null and [Placeholder_1] = 'Cost per Acquisition' and [Campaign Name] = @CampaignName";
	
kpi_sla_cost_per_consumer = "select distinct [Campaign Name],[Placeholder_2] as numericValue from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Campaign Name] is not null and [Placeholder_1] = 'Cost per Consumer (Redemption)' and [Campaign Name] = @CampaignName";
	
kpi_sla_cost_per_entry = "select distinct [Campaign Name],[Placeholder_2] as numericValue from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Campaign Name] is not null and [Placeholder_1] = 'Cost per Entry(Redemption)' and [Campaign Name] = @CampaignName";
	
kpi_sla_cost_bifurcation = "select distinct [Campaign Name],Placeholder_1 as name,[Placeholder_2] as y from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Campaign Name] is not null and [Placeholder_1] in ('Fixed','Variable') and [Campaign Name] like %@CampaignName% order by y desc";
	
kpi_sla_cost_distribution = "select distinct [Campaign Name],Placeholder_1 as name,[Placeholder_2] as y from [Unilever_CampaignDashboard].[dbo].[SLACOST] where [Campaign Name] is not null and [Campaign Name] in ('Wheel_HHT','Wheel_Viral','Rin_HHT','Rin_Viral') and [Campaign Name] like %@CampaignName%";
	
==================================	
	
kpi_profiling_contact_to_purchase = "SELECT [Dummy2] as 'name' ,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileContentToPurchase] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question and [Dummy2]!='' group by [Dummy2] order by y desc";
	
kpi_profiling_repeat_purchase_behaviour = "SELECT [Dummy3] 'name',sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileRepeatPurchase] where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question and [Dummy3]!='' group by [Dummy3] order by y desc";
	
kpi_profiling_user_vs_redemption = "SELECT [Dummy3] 'name',sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileUserRedemption] where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and Question=@Question and [Dummy3]>3 group by [Dummy3] order by name asc";
	
kpi_profiling_response_distribution = "select answer2 as name,sum(MobileCount) as y from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileResponseDistribution] where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and ([InteractionDate] between @Startdate and @Enddate) and Question2=@Question and Answer2 is not null group by answer2  order by y desc";
	
kpi_profiling_redemptions = "select * from (SELECT sum([MobileCount]) as numericValue FROM  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%Coup%'  and  [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call]  )as a";
	
kpi_profiling_missed_calls_received = "select * from (SELECT sum([MobileCount]) as numericValue FROM  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%Missed%' and  [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call]  )as a";
	
kpi_profiling_obd_calls = "select * from (SELECT sum([MobileCount]) as numericValue FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%obd%'  and  [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target  and [Category]=@Category and [Channel]=@Channel and [Region]=@Region  and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call]  )as a";
	
kpi_profiling_calls_answered = "select * from (SELECT sum([MobileCount]) as numericValue FROM   [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%obd%' and [Duration]>0 and  [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call]  )as a";
	
kpi_profiling_sms_sent = "select * from (SELECT sum([MobileCount]) as numericValue FROM  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%sms%'  and  [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target  and [Category]=@Category and [Channel]=@Channel and [Region]=@Region  and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call] )as a";
	
kpi_profiling_sms_delivered = "select * from (SELECT sum([MobileCount]) as numericValue FROM  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_ProfileAggregate] where [Type of Call] like '%sms%'  and  [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target  and [Category]=@Category and [Channel]=@Channel and [Region]=@Region  and ([InteractionDate] between @Startdate and @Enddate) and Question=@Question group by [Type of Call] )as a";
	
	
==================================	
	
kpi_metrics_contact_to_action = "SELECT [Dummy2] 'name',sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialContentToPurchase] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [Dummy2]!='' group by [Dummy2] order by y desc";
	
kpi_metrics_user_vs_redemption = "SELECT [Dummy3] 'name',sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialUserRedemption] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region group by [Dummy3] order by name asc";
	
kpi_metrics_repeat_redemption_behaviour = "SELECT [Dummy3] 'name',sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialRepeatPurchase] where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [Dummy3]!='' group by [Dummy3] order by y desc";
	
kpi_metrics_sales_response_rate = "SELECT 'Sales Response Rate'[KPI],* FROM (SELECT [DayofWeek],[Hour],case when brand='Rin' then (cast([Counts] as float)*100)/2100000 when Brand='Wheel' and SKU like '%10%' then (cast([Counts] as float)*100)/960000 when Brand='Wheel' and SKU like '%400%' then (cast([Counts] as float)*100)/600253 when Brand='Wheel' and SKU like '%800%' then (cast([Counts] as float)*100)/500000  end as [Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_PivotSalesResponserate] where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate)) as s PIVOT ( SUM([Counts]) FOR [Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]) )AS pvt";	
	
kpi_metrics_engagement_rate = "SELECT 'Engagement Rate'[KPI],* FROM ( SELECT a.[DayofWeek],a.[Hour],(cast ([Counts] as float))/(cast (overallEngagement as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_PivotEngRate_1] a where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate)) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]) )AS pvt";
	
kpi_metrics_interaction_rate = "SELECT 'Interaction Rate'[KPI],* FROM ( SELECT a.[DayofWeek],a.[Hour],(cast ([Counts] as float))/(cast (overallInteraction as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_PivotIntRate_1] a where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate)) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]) )AS pvt";
	
kpi_metrics_connection_rate = "SELECT 'Engagement Rate'[KPI],* FROM ( SELECT a.[DayofWeek],a.[Hour],(cast ([Counts] as float))/(cast (overallEngagement as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_PivotEngRate_1] a where [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate)) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]) )AS pvt";
	
=============================	
	
kpi_summary_calls_profiling = "select call_metric as name,sum(metriccount) as y from (select 'MISSED CALLS RECEIVED' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region union all select 'OBD CALLS' as call_metric,'CALLS PROFILING & CALL METRICS' as widget, b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'OBD Engagement' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region union all select 'CALLS ANSWERED' as call_metric,'CALLS PROFILING & CALL METRICS' as widget, b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'OBD Engagement' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region union all select 'REDEMPTIONS' as call_metric,'CALLS PROFILING & CALL METRICS' as widget, b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] b where b.[Type of Call] = 'Coupon Redemption' and b.[Voucher Code Valid] = 'Y' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region ) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region=@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by call_metric order by y desc";
	
kpi_summary_users_profiling = "select KPI as name, sum(counts) as y from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare]  group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku  and a.InteractionDate between @Startdate and @Enddate group by KPI order by y desc";
	
kpi_summary_sms_sent = "select sum(MobileCount) numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate]  a where [Type of Call] = 'SMS' and  a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku  and (a.InteractionDate between @Startdate and @Enddate)";
	
kpi_summary_sms_delivered = "select sum(MobileCount) numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate]  a where [Type of Call] = 'SMS' and  a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku  and (a.InteractionDate between @Startdate and @Enddate)";
	
kpi_summary_bpo_calls_made = "select sum(MobileCount) numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate]  a where [Type of Call] = 'BPO CALL' and  a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku  and (a.InteractionDate between @Startdate and @Enddate)";
	
kpi_summary_average_call_duration = "select avg(AVERAGE) as numericValue  from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate] ,avg(avg_duration) as AVERAGE from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixAvgDuration] where KPI = 'Connected' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate])as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate";
	
kpi_summary_kpi_metrics_weekly = "select KPI, case when len(datepart(week,[InteractionDate]))=1 then '0'+CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end AS Year ,sum(counts) as Counts  from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(week,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(week,[InteractionDate])";
	
kpi_summary_kpi_metrics_monthly = "select KPI, case when len(datepart(month,[InteractionDate]))=1 then '0'+CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end AS Year, sum(counts) as Counts from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(month,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(month,[InteractionDate])";
	
kpi_summary_kpi_metrics_quarterly = "select KPI, CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) AS Year, sum(counts) as Counts  from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku  and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(quarter,[InteractionDate]) ,datepart(year,[InteractionDate]) order by Year asc";
	
kpi_summary_kpi_metrics_daily = "select KPI, sum(counts) as Counts, [InteractionDate] as Year from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI, [InteractionDate] order by Year asc";
	
kpi_summary_call_metrics_weekly = "select KPI, sum(counts) as Counts, case when len(datepart(week,[InteractionDate]))=1 then '0'+CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end AS Year from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Reached'  group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts union all select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Missed Call' group by  [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) union all  select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and b.[Voucher Code Valid] = 'Y' group by [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) ) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(week,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(week,[InteractionDate])";
	
kpi_summary_call_metrics_monthly = "select KPI, sum(counts) as Counts, case when len(datepart(month,[InteractionDate]))=1 then '0'+CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end  AS Year from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Reached' group by  KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts union all select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Missed Call' group by  [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) union all select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and b.[Voucher Code Valid] = 'Y' group by  [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) ) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(month,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(month,[InteractionDate])";
	
kpi_summary_call_metrics_quarterly = "select KPI, sum(counts) as Counts, CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) AS Year from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare] where KPI = 'Reached' group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts union all select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Missed Call' group by  [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) union all select [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and b.[Voucher Code Valid] = 'Y' group by  [Type of Call] ,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) ) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by KPI, CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) order by Year asc;";
	
kpi_summary_call_metrics_daily = "select KPI, sum(counts) as Counts,[InteractionDate] as Year from (select  KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixKPIDuplicateAggregare]  group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[SKU],[InteractionDate],counts)as a where KPI = 'Reached' group by KPI,[InteractionDate] union all select call_metric,sum(metriccount) Counts,InteractionDate from (select 'Missed Call' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast(b.InteractionDate as date) InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region union all select 'REDEMPTION' as call_metric,'CALLS PROFILING & CALL METRICS' as widget, cast(b.InteractionDate as date) InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region,sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_TransactiondetialAggregate] b where b.[Type of Call] = 'Coupon Redemption' and b.[Voucher Code Valid] = 'Y' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Incentive,b.Target,b.Category,b.Channel,b.Region ) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.InteractionDate between @Startdate and @Enddate group by call_metric,InteractionDate order by Year asc;";


===============================================	
	
kpi_dmmetrics_contact_to_action_before = "SELECT [ContenttoPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransContentTopurchase] where [DuringAfterBefore] = 'Before' and [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [ContenttoPurchase] order by y desc";
	
kpi_dmmetrics_contact_to_action_during = "SELECT [ContenttoPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransContentTopurchase] where [DuringAfterBefore] = 'During' and [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [ContenttoPurchase] order by y desc";
	
kpi_dmmetrics_contact_to_action_after = "SELECT [ContenttoPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransContentTopurchase] where [DuringAfterBefore] = 'After' and [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [ContenttoPurchase] order by y desc";
	
	
kpi_dmmetrics_user_vs_redemption_before = "SELECT [Dummy3] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_userRedemption] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region group by [Dummy3] order by name asc";
	
kpi_dmmetrics_user_vs_redemption_during = "SELECT [Dummy3] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_userRedemption] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region group by [Dummy3] order by name asc";
	
kpi_dmmetrics_user_vs_redemption_after = "SELECT [Dummy3] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_userRedemption] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region group by [Dummy3] order by name asc";
	
	
kpi_dmmetrics_repeat_redemption_behaviour_before = "SELECT [RepeatPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransRepeatPurchase] where [DuringAfterBefore] = 'Before' and [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [RepeatPurchase] order by y desc";
	
kpi_dmmetrics_repeat_redemption_behaviour_during = "SELECT [RepeatPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransRepeatPurchase] where [DuringAfterBefore] = 'During' and [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [RepeatPurchase] order by y desc";
	
kpi_dmmetrics_repeat_redemption_behaviour_after = "SELECT [RepeatPurchase] as name,sum(isnull([MobileCount],0)) as y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransRepeatPurchase] where [DuringAfterBefore] = 'After' and [CampaignName]=@CampaignName and  [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort group by [RepeatPurchase] order by y desc";
	
	
kpi_dmmetrics_sales_response_rate = "SELECT 'Sales Response Rate'[KPI],[DayofWeek], isnull([1],0)[1],isnull([2],0)[2],isnull([3],0)[3], isnull([4],0)[4],isnull([5],0)[5],isnull([6],0)[6], isnull([7],0)[7],isnull([8],0)[8],isnull([9],0)[9], isnull([10],0)[10],isnull([11],0)[11],isnull([12],0)[12], isnull([13],0)[13],isnull([14],0)[14],isnull([15],0)[15],isnull([16],0)[16], isnull([17],0)[17],isnull([18],0)[18],isnull([19],0)[19], isnull([20],0)[20],isnull([21],0)[21],isnull([22],0)[22],isnull([23],0)[23] FROM ( SELECT [DayofWeek],[Hour],case when brand='Rin' then (cast([MobileCount] as float)*100)/2100000 when Brand='Wheel' and SKU like '%10%' then (cast([MobileCount] as float)*100)/960000 when Brand='Wheel' and SKU like '%400%' then (cast([MobileCount] as float)*100)/600253 when Brand='Wheel' and SKU like '%800%' then (cast([MobileCount] as float)*100)/500000  end as [Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMPivotSalesResponserate] where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU]=@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort]=@Cohort and [DuringAfterBefore] = @DuringAfterBefore ) as s PIVOT ( SUM([Counts]) FOR [Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]) )AS pvt";
	
kpi_dmmetrics_engagement_rate = "SELECT 'Engagement Rate'[KPI],[DayofWeek],isnull([1],0)[1],isnull([2],0)[2],isnull([3],0)[3],isnull([4],0)[4],isnull([5],0)[5],isnull([6],0)[6], isnull([7],0)[7],isnull([8],0)[8],isnull([9],0)[9],isnull([10],0)[10],isnull([11],0)[11],isnull([12],0)[12], isnull([13],0)[13],isnull([14],0)[14],isnull([15],0)[15],isnull([16],0)[16],isnull([17],0)[17],isnull([18],0)[18],isnull([19],0)[19], isnull([20],0)[20],isnull([21],0)[21],isnull([22],0)[22],isnull([23],0)[23] FROM (SELECT a.[DayofWeek],a.[Hour],(cast ([MobileCount] as float))/(cast (overallEngagement as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMPivotEngRate] a where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort] = @Cohort and [DuringAfterBefore] = @DuringAfterBefore ) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]))AS pvt";
	
kpi_dmmetrics_interaction_rate = "SELECT 'Interaction Rate'[KPI],[DayofWeek], isnull([1],0)[1],isnull([2],0)[2],isnull([3],0)[3],isnull([4],0)[4],isnull([5],0)[5],isnull([6],0)[6], isnull([7],0)[7],isnull([8],0)[8],isnull([9],0)[9],isnull([10],0)[10],isnull([11],0)[11],isnull([12],0)[12], isnull([13],0)[13],isnull([14],0)[14],isnull([15],0)[15],isnull([16],0)[16],  isnull([17],0)[17],isnull([18],0)[18],isnull([19],0)[19],isnull([20],0)[20],isnull([21],0)[21],isnull([22],0)[22],isnull([23],0)[23] FROM ( SELECT a.[DayofWeek],a.[Hour],(cast ([MobileCount] as float))/(cast (overallInteraction as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMPivotIntRate] a where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort] = @Cohort and [DuringAfterBefore]=@DuringAfterBefore) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]))AS pvt";
	
kpi_dmmetrics_connection_rate = "SELECT 'Engagement Rate'[KPI],[DayofWeek],isnull([1],0)[1],isnull([2],0)[2],isnull([3],0)[3],isnull([4],0)[4],isnull([5],0)[5],isnull([6],0)[6], isnull([7],0)[7],isnull([8],0)[8],isnull([9],0)[9],isnull([10],0)[10],isnull([11],0)[11],isnull([12],0)[12], isnull([13],0)[13],isnull([14],0)[14],isnull([15],0)[15],isnull([16],0)[16],isnull([17],0)[17],isnull([18],0)[18],isnull([19],0)[19], isnull([20],0)[20],isnull([21],0)[21],isnull([22],0)[22],isnull([23],0)[23] FROM (SELECT a.[DayofWeek],a.[Hour],(cast ([MobileCount] as float))/(cast (overallEngagement as float) )[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMPivotEngRate] a where [CampaignName]=@CampaignName and [Brand]=@Brand and [SKU] =@Sku and [Target]=@Target and [Category]=@Category and [Channel]=@Channel and [Region]=@Region and ([InteractionDate] between @Startdate and @Enddate) and [DM]=@Dm and [Cohort] = @Cohort and [DuringAfterBefore] = @DuringAfterBefore ) as s PIVOT ( SUM([Counts]) FOR s.[Hour] IN ([0],[1],[2],[3],[4],[5],[6],[7],[8],[9],[10],[11],[12],[13],[14],[15],[16],[17],[18],[19],[20],[21],[22],[23]))AS pvt";

================================	
	
kpi_dmsummary_redemptions_before = "select sum(metriccount) as numericValue from (select 'Coupons Redeemed' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region ,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and [DuringAfterBefore] ='Before'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_redemptions_during = "select sum(metriccount) as numericValue from (select 'Coupons Redeemed' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region ,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and [DuringAfterBefore] ='During'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_redemptions_after = "select sum(metriccount) as numericValue from (select 'Coupons Redeemed' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region ,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption' and [DuringAfterBefore] ='After'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.InteractionDate between @Startdate and @Enddate";
	
	
kpi_dmsummary_missed_calls_received = "select sum(metriccount) as numericValue from (select 'Missed Call' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region ,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_obd_calls = "select sum(metriccount) as numericValue from (select 'OBD ENGAGEMENT' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category ,b.Channel,b.Region,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'OBD Engagement'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_calls_answered = "select sum(metriccount) as numericValue from (select 'Calls Answered' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,isnull(b.SKU,'') SKU,b.Target,b.Category,b.Channel,b.Region ,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregateCallsAnswered] B group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_sms_sent = "select sum(metriccount) as numericValue from (select 'SMS Delivered' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category ,b.Channel,b.Region,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'SMS' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_sms_delivered = "select sum(metriccount) as numericValue from (select 'SMS Delivered' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category ,b.Channel,b.Region,b.[DM]  , b.[Cohort] , b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'SMS' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate";
	
kpi_dmsummary_call_metrics_quarterly = "select call_metric as KPI,sum(metriccount) as Counts,CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) as Year from (select 'OBD ENGAGEMENT' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate], b.CampaignName,b.Brand,b.SKU,b.Target,b.Category ,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'OBD Engagement' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Missed Call' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Coupons Redeemed' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by call_metric,CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) order by Year asc";
	
kpi_dmsummary_call_metrics_daily = "select call_metric as KPI,sum(metriccount) as Counts,[InteractionDate] as Year from (select 'OBD ENGAGEMENT' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] ,sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'OBD Engagement'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Missed Call' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate], b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Coupons Redeemed' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B where b.[Type of Call] = 'Coupon Redemption' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore])as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by call_metric,[InteractionDate]";
	
kpi_dmsummary_call_metrics_weekly = "select call_metric as KPI,sum(metriccount) as Counts, case when len(datepart(week,[InteractionDate]))=1 then '0'+CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end AS Year from (select 'OBD ENGAGEMENT' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'OBD Engagement'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Missed Call' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Coupons Redeemed' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category  and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by call_metric,datepart(year,[InteractionDate]), CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(week,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(week,[InteractionDate])";
	
kpi_dmsummary_call_metrics_monthly = "select call_metric as KPI,sum(metriccount) as Counts, case when len(datepart(month,[InteractionDate]))=1 then '0'+CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end as Year from (select 'OBD ENGAGEMENT' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate], b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B where b.[Type of Call] = 'OBD Engagement'  group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Missed Call' as  call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from  [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Missed Call' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore] union all select 'Coupons Redeemed' as call_metric,'CALLS PROFILING & CALL METRICS' as widget,cast([InteractionDate] as date) [InteractionDate] , b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore],sum(b.MobileCount) metriccount from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_Tempfix_DMTransAggregate] B  where b.[Type of Call] = 'Coupon Redemption' group by b.[Type of Call],b.InteractionDate, b.CampaignName,b.Brand,b.SKU,b.Target,b.Category,b.Channel,b.Region,b.[DM],b.[Cohort],b.[DuringAfterBefore]) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] = @Dm and a.[Cohort] = @Cohort and a.[DuringAfterBefore] =@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by call_metric,datepart(year,[InteractionDate]), CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(month,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(month,[InteractionDate])";
	
kpi_dmsummary_kpi_metrics_quarterly = "select KPI, sum(counts) as Counts,  CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) as Year from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixDMKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] =@Dm and a.[Cohort]=@Cohort and a.[DuringAfterBefore]=@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by KPI,  CONCAT(datepart(quarter,[InteractionDate]), ' ' ,datepart(year,[InteractionDate])) order by Year asc";
	
kpi_dmsummary_kpi_metrics_daily = "select KPI, sum(counts) as Counts, [InteractionDate] as Year from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixDMKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] =@Dm and a.[Cohort]=@Cohort and a.[DuringAfterBefore]=@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by KPI, [InteractionDate]";
	
kpi_dmsummary_kpi_metrics_weekly = "select KPI, sum(counts) as Counts, case when len(datepart(week,[InteractionDate]))=1 then '0'+CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end  as Year from ( select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixDMKPIDuplicateAggregare]  group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] =@Dm and a.[Cohort]=@Cohort and a.[DuringAfterBefore]=@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(week,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(week,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(week,[InteractionDate])";
	
kpi_dmsummary_kpi_metrics_monthly = "select KPI, sum(counts) as Counts, case when len(datepart(month,[InteractionDate]))=1 then '0'+CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) else CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])) end  as Year from (select KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],cast([InteractionDate] as date) [InteractionDate],counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_TempFixDMKPIDuplicateAggregare] group by KPI,[Target],[Channel],[Category],[CampaignName],[Region],[Brand],[DM],[Cohort],[DuringAfterBefore],[SKU],[InteractionDate],counts) as a where a.CampaignName = @CampaignName and a.Brand=@Brand and a.Target=@Target and a.Category = @Category and a.channel = @Channel and a.Region  =@Region and a.SKU=@Sku and a.[DM] =@Dm and a.[Cohort]=@Cohort and a.[DuringAfterBefore]=@DuringAfterBefore and a.InteractionDate between @Startdate and @Enddate group by KPI,datepart(year,[InteractionDate]), CONCAT(datepart(month,[InteractionDate]), ' ', datepart(Year,[InteractionDate])),datepart(month,[InteractionDate]),datepart(Year,[InteractionDate]) order by 1,datepart(year,[InteractionDate]),datepart(month,[InteractionDate])";	
	
======================
	
prm_usage_core = "select count(distinct ID) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where typeofbrief='Core' and [Request Received]>=@Startdate and [Request Received]<=@Enddate";
	
prm_usage_analytics = "select count(distinct ID) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where typeofbrief='Analysis' and [Request Received]>=@Startdate and [Request Received]<=@Enddate";
	
prm_usage_category = "select [Category Type] as name,count(distinct id) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where [Request Received]>=@Startdate and [Request Received]<=@Enddate group by [Category Type]";
	
prm_usage_channel = "select [Channel] as name,count(distinct id) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where [Request Received]>=@Startdate and [Request Received]<=@Enddate group by [Channel]";
	
prm_usage_campaign = "select [CampaignType] as name,count(distinct id) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where [Request Received]>=@Startdate and [Request Received]<=@Enddate group by [CampaignType]";
	
prm_usage_target = "SELECT [Target] as name ,count(distinct [ID])y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where  [Typeofbrief]='Core'and [Request Received]>=@Startdate and [Request Received]<=@Enddate group by [Target]";
	
prm_usage_brand = "select brand as name,count(distinct id) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where [Request Received]>=@Startdate and [Request Received]<=@Enddate group by brand order by y desc";
	
prm_usage_all = "SELECT [Brand],[Category Type] as CategoryType,[Typeofbrief],[Type],[Request Received],[CampaignType] ,[Channel],[Target],count([ID]) counts FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMUsage] where brand is not null group by[Brand],[Category Type],[Typeofbrief],[Type],[Request Received],[CampaignType],[Channel],[Target]";

===========================	
	
prm_pyramid_pyramid = "select KPI as name,sum(Counts) y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMPyramid] where Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by KPI order by y";
	
prm_pyramid_age = "select Optionvalue as name,Sum(Counts) y FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='Age' and Optionvalue!='' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by Optionvalue";
	
prm_pyramid_gender = "select Optionvalue as label,Sum(Counts) counts FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='Gender' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by Optionvalue";
	
prm_pyramid_name = "select Sum(Counts) numericValue FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='Name' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by KPI";
	
prm_pyramid_location = "select Optionvalue as label,Sum(Counts) counts  FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='City' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by Optionvalue";
	
prm_pyramid_emailid = "select Sum(Counts) numericValue  FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='Emailid' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by KPI";
	
prm_pyramid_pincode = "select Sum(Counts) numericValue  FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where KPI='Pincode' and Provider IN (@Provider) and Brand IN (@Brand) and Category IN (@Category) and Circle IN (@Circle) and LSM IN (@LSM) group by KPI";
	
prm_pyramid_city = "SELECT [KPI],Sum(Counts) numericValue  FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_GPQ] where [KPI]='City' and [provider] IN (@Provider) and [brand] IN (@Brand) and  [category] IN (@Category) and [circle] IN (@Circle)  and [LSM] IN (@LSM) group by [KPI]";

===========================	
	
prm_overview_yoy = "select * from (SELECT  [Filter],[Optionvalue],round((cast(Counts as float)/1000000),2)Counts FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='YOY' and Optionvalue is not null union SELECT 'Baseline',a.[Optionvalue], (SELECT sum(round((cast(Counts as float)/1000000),2))[Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] b WHERE  b.[Optionvalue] <= a.[Optionvalue]  and b.Filter='YOY' and b.Optionvalue is not null) FROM   [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] a WHERE  a.Filter='YOY' and a.Optionvalue is not null) as c ORDER  BY [Filter],[Optionvalue];";
	
prm_overview_prmbase = "select round((cast(Counts as float)/1000000),2) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='PRM Base'";
	
prm_overview_optin = "select round((cast(Counts as float)/1000000),2) as numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='Optin'";
	
prm_overview_provider = "select Optionvalue as name, round((cast(Counts as float)/1000000),2) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='provider' order by y";
	
prm_overview_category = "select Optionvalue as name, round((cast(Counts as float)/1000000),2) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='Category' order by y";
	
prm_overview_brand = "select Optionvalue as name, round((cast(Counts as float)/1000000),2) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='Brand' order by y desc";
	
prm_overview_lsm = "select Optionvalue as LSM,round((cast(Counts as float)/1000000),2) as Counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='LSM' and Optionvalue!='' order by Optionvalue desc";
	
prm_overview_recency = "select Optionvalue as Recency,round((cast(Counts as float)/1000000),2) as Counts from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='recency' order by Counts desc";
	
prm_overview_region = "select Optionvalue as name, round((cast(Counts as float)/1000000),2) as y from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOverview] where Filter='Circle' order by y desc";
	
prm_overview_all = "SELECT [Year],[provider],[category],[brand],([lsm]+';'+[confidence]) LSM,[region],[Recency],[optin], 'Y' as prmBase, [Counts] FROM [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMOVerviewWidget]";

============================	
	
prm_basecalculator_mobile = "select sum(Counts) numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMCalculator] where  KPI='Mobile' and [Circle] in (@Circle)  and [Category] in (@Category) and [Brand] in (@Brand) and LSM in (@LSM) and city in (@city)  and recency in (@Recency) and [Age] in (@Age) and [Gender] in (@Gender) and [TraderCustomer] in (@TraderCustomer)";
	
prm_basecalculator_email = "select sum(Counts) numericValue from [Unilever_CampaignDashboard].[dbo].[SingleViewDashboard_PRMDashboard_PRMCalculator] where  KPI='Email' and [Circle] in (@Circle) and [Category] in (@Category) and city in (@city) and [Brand] in (@Brand) and LSM in (@LSM) and recency in (@Recency) and [Age] in (@Age) and [Gender] in (@Gender) and [TraderCustomer] in (@TraderCustomer)";	
